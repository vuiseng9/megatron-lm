python ../../pretrain_gpt.py -h | grep -o '^  --[^ ]*' 
  --num-layers
  --encoder-num-layers
  --decoder-num-layers
  --hidden-size
  --ffn-hidden-size
  --num-attention-heads
  --attention-backend
  --kv-channels
  --group-query-attention
  --num-query-groups
  --max-position-embeddings
  --position-embedding-type
  --relative-attention-num-buckets
  --relative-attention-max-distance
  --use-rotary-position-embeddings
  --rotary-base
  --rotary-percent
  --rotary-interleaved
  --rotary-seq-len-interpolation-factor
  --use-rope-scaling
  --rope-scaling-factor
  --no-rope-freq
  --no-position-embedding
  --mrope-section
  --make-vocab-size-divisible-by
  --normalization
  --norm-epsilon
  --apply-layernorm-1p
  --apply-residual-connection-post-layernorm
  --openai-gelu
  --squared-relu
  --swiglu
  --onnx-safe
  --bert-no-binary-head
  --untie-embeddings-and-output-weights
  --multi-latent-attention
  --mtp-num-layers
  --mtp-loss-scaling-factor
  --attention-dropout
  --hidden-dropout
  --weight-decay
  --start-weight-decay
  --end-weight-decay
  --weight-decay-incr-style
  --clip-grad
  --adam-beta1
  --adam-beta2
  --adam-eps
  --sgd-momentum
  --micro-batch-size
  --batch-size
  --global-batch-size
  --rampup-batch-size
  --decrease-batch-size-if-needed
  --recompute-activations
  --recompute-granularity
  --no-check-for-nan-in-loss-and-grad
  --check-for-spiky-loss
  --check-for-large-grads
  --distribute-saved-activations
  --recompute-method
  --recompute-num-layers
  --recompute-modules
  --no-clone-scatter-output-in-embedding
  --profile
  --profile-step-start
  --profile-step-end
  --iterations-to-skip
  --result-rejected-tracker-filename
  --disable-gloo-process-groups
  --use-pytorch-profiler
  --profile-ranks
  --record-memory-history
  --memory-snapshot-path
  --tp-comm-overlap
  --tp-comm-overlap-cfg
  --disable-tp-comm-overlap-ag
  --disable-tp-comm-overlap-rs
  --tp-comm-overlap-rs-dgrad
  --disable-tp-comm-bulk-dgrad
  --disable-tp-comm-bulk-wgrad
  --tp-comm-bootstrap-backend
  --use-cpu-initialization
  --empty-unused-memory-level
  --deterministic-mode
  --check-weight-hash-across-dp-replicas-interval
  --calculate-per-token-loss
  --train-sync-interval
  --checkpoint-activations
  --train-iters
  --train-samples
  --log-interval
  --exit-interval
  --exit-duration-in-mins
  --exit-signal-handler
  --tensorboard-dir
  --no-masked-softmax-fusion
  --no-bias-gelu-fusion
  --no-bias-swiglu-fusion
  --use-fused-weighted-squared-relu
  --no-bias-dropout-fusion
  --no-rope-fusion
  --rope-type
  --cross-entropy-loss-fusion
  --cross-entropy-fusion-impl
  --use-flash-attn
  --disable-bias-linear
  --add-qkv-bias
  --optimizer
  --optimizer-cpu-offload
  --optimizer-offload-fraction
  --use-torch-optimizer-for-cpu-offload
  --overlap-cpu-optimizer-d2h-h2d
  --no-pin-cpu-grads
  --no-pin-cpu-params
  --dataloader-type
  --no-async-tensor-model-parallel-allreduce
  --no-persist-layer-norm
  --sequence-parallel
  --no-gradient-accumulation-fusion
  --use-mcore-models
  --use-legacy-models
  --manual-gc
  --manual-gc-interval
  --no-manual-gc-eval
  --disable-tp-comm-split-ag
  --disable-tp-comm-split-rs
  --pipeline-model-parallel-comm-backend
  --high-priority-stream-groups
  --seed
  --data-parallel-random-init
  --init-method-std
  --embedding-init-method-std
  --init-method-xavier-uniform
  --lr
  --lr-decay-style
  --lr-wsd-decay-style
  --lr-decay-iters
  --lr-decay-samples
  --lr-wsd-decay-samples
  --lr-wsd-decay-iters
  --lr-warmup-fraction
  --lr-warmup-iters
  --lr-warmup-samples
  --lr-warmup-init
  --warmup
  --min-lr
  --override-opt_param-scheduler
  --use-checkpoint-opt_param-scheduler
  --decoupled-lr
  --decoupled-min-lr
  --save
  --save-interval
  --save-retain-interval
  --no-save-optim
  --no-save-rng
  --load
  --no-load-optim
  --load-main-params-from-ckpt
  --no-load-rng
  --no-strict-fsdp-dtensor-load
  --non-persistent-save-interval
  --non-persistent-ckpt-type
  --non-persistent-global-ckpt-dir
  --non-persistent-local-ckpt-dir
  --non-persistent-local-ckpt-algo
  --finetune
  --pretrained-checkpoint
  --ckpt-step
  --no-initialization
  --use-checkpoint-args
  --use-mp-args-from-checkpoint-args
  --no-use-tokenizer-model-from-checkpoint-args
  --exit-on-missing-checkpoint
  --use-dist-ckpt
  --use-persistent-ckpt-worker
  --auto-detect-ckpt-format
  --dist-ckpt-format
  --ckpt-format
  --ckpt-convert-format
  --ckpt-convert-save
  --ckpt-convert-update-legacy-dist-opt-format
  --ckpt-fully-parallel-save
  --no-ckpt-fully-parallel-save
  --async-save
  --ckpt-fully-parallel-load
  --ckpt-assume-constant-structure
  --dist-ckpt-strictness
  --load-model-opt-format
  --fp16
  --bf16
  --grad-reduce-in-bf16
  --loss-scale
  --initial-loss-scale
  --min-loss-scale
  --loss-scale-window
  --hysteresis
  --fp32-residual-connection
  --apply-query-key-layer-scaling
  --attention-softmax-in-fp32
  --accumulate-allreduce-grads-in-fp32
  --fp16-lm-cross-entropy
  --disable-bf16-reduced-precision-matmul
  --reuse-grad-buf-for-mxfp8-param-ag
  --tensor-model-parallel-size
  --pipeline-model-parallel-size
  --decoder-first-pipeline-num-layers
  --decoder-last-pipeline-num-layers
  --pipeline-model-parallel-layout
  --model-parallel-size
  --num-layers-per-virtual-pipeline-stage
  --num-virtual-stages-per-pipeline-rank
  --microbatch-group-size-per-virtual-pipeline-stage
  --no-overlap-p2p-communication
  --overlap-p2p-communication-warmup-flush
  --distributed-backend
  --distributed-timeout-minutes
  --overlap-grad-reduce
  --defer-embedding-wgrad-compute
  --wgrad-deferral-limit
  --no-align-grad-reduce
  --ddp-num-buckets
  --ddp-bucket-size
  --ddp-pad-buckets-for-high-nccl-busbw
  --ddp-average-in-collective
  --overlap-param-gather
  --overlap-param-gather-with-optimizer-step
  --no-align-param-gather
  --no-scatter-gather-tensors-in-pipeline
  --use-ring-exchange-p2p
  --local-rank
  --lazy-mpu-init
  --account-for-embedding-in-pipeline-split
  --account-for-loss-in-pipeline-split
  --use-distributed-optimizer
  --use-nccl-ub
  --use-sharp
  --sharp-enabled-group
  --use-megatron-fsdp
  --init-model-with-meta-device
  --data-parallel-sharding-strategy
  --no-gradient-reduce-div-fusion
  --fsdp-double-buffer
  --suggested-communication-unit-size
  --keep-fp8-transpose-cache
  --enable-full-sharding-in-hsdp
  --num-distributed-optimizer-instances
  --use-torch-fsdp2
  --torch-fsdp2-no-reshard-after-forward
  --context-parallel-size
  --cp-comm-type
  --hierarchical-context-parallel-sizes
  --nccl-communicator-config-path
  --use-tp-pp-dp-mapping
  --replication
  --replication-jump
  --replication-factor
  --full-validation
  --multiple-validation-sets
  --eval-iters
  --eval-interval
  --test-mode
  --skip-train
  --data-path
  --split
  --train-data-path
  --valid-data-path
  --test-data-path
  --data-args-path
  --per-split-data-args-path
  --data-cache-path
  --no-mmap-bin-files
  --mock-data
  --seq-length
  --encoder-seq-length
  --decoder-seq-length
  --retriever-seq-length
  --sample-rate
  --mask-prob
  --short-seq-prob
  --num-workers
  --reset-position-ids
  --reset-attention-mask
  --eod-mask-loss
  --no-create-attention-mask-in-dataloader
  --num-dataset-builder-threads
  --object-storage-cache-path
  --mid-level-dataset-surplus
  --vocab-size
  --padded-vocab-size
  --vocab-file
  --merge-file
  --vocab-extra-ids
  --tokenizer-type
  --tokenizer-model
  --tiktoken-pattern
  --tiktoken-num-special-tokens
  --tiktoken-special-tokens
  --adlr-autoresume
  --adlr-autoresume-interval
  --ict-head-size
  --biencoder-projection-dim
  --biencoder-shared-query-context-model
  --ict-load
  --bert-load
  --titles-data-path
  --query-in-block-prob
  --use-one-sent-docs
  --evidence-data-path
  --retriever-report-topk-accuracies
  --retriever-score-scaling
  --block-data-path
  --embedding-path
  --indexer-batch-size
  --indexer-log-interval
  --num-classes
  --img-h
  --img-w
  --num-channels
  --patch-dim
  --classes-fraction
  --data-per-class-fraction
  --no-data-sharding
  --head-lr-mult
  --vision-pretraining
  --vision-pretraining-type
  --vision-backbone-type
  --swin-backbone-type
  --mask-type
  --mask-factor
  --iter-per-epoch
  --dino-local-img-size
  --dino-local-crops-number
  --dino-head-hidden-size
  --dino-bottleneck-size
  --dino-freeze-last-layer
  --dino-norm-last-layer
  --dino-warmup-teacher-temp
  --dino-teacher-temp
  --dino-warmup-teacher-temp-epochs
  --qk-layernorm
  --qk-l2-norm
  --expert-model-parallel-size
  --expert-tensor-parallel-size
  --num-experts
  --moe-layer-freq
  --moe-ffn-hidden-size
  --moe-shared-expert-intermediate-size
  --moe-shared-expert-overlap
  --moe-grouped-gemm
  --moe-use-legacy-grouped-gemm
  --moe-layer-recompute
  --moe-extended-tp
  --moe-use-upcycling
  --moe-router-load-balancing-type
  --moe-router-dtype
  --moe-router-fusion
  --moe-router-score-function
  --moe-router-topk
  --moe-router-pre-softmax
  --moe-router-num-groups
  --moe-router-group-topk
  --moe-router-topk-scaling-factor
  --moe-router-enable-expert-bias
  --moe-router-bias-update-rate
  --moe-router-force-load-balancing
  --moe-router-padding-for-fp8
  --moe-aux-loss-coeff
  --moe-z-loss-coeff
  --moe-input-jitter-eps
  --moe-per-layer-logging
  --moe-token-dispatcher-type
  --moe-enable-deepep
  --moe-deepep-num-sms
  --moe-permute-fusion
  --moe-expert-capacity-factor
  --moe-pad-expert-input-to-capacity
  --moe-token-drop-policy
  --moe-apply-probs-on-input
  --overlap-moe-expert-parallel-comm
  --delay-wgrad-compute
  --moe-upcycling-granularity
  --q-lora-rank
  --kv-lora-rank
  --qk-head-dim
  --qk-pos-emb-head-dim
  --v-head-dim
  --rotary-scaling-factor
  --mscale
  --mscale-all-dim
  --cache-mla-latents
  --heterogeneous-layers-config-path
  --heterogeneous-layers-config-encoded-json
  --log-params-norm
  --log-num-zeros-in-grad
  --log-throughput
  --log-progress
  --timing-log-level
  --log-energy
  --no-barrier-with-level-1-timing
  --timing-log-option
  --tensorboard-log-interval
  --tensorboard-queue-size
  --log-timers-to-tensorboard
  --no-log-loss-scale-to-tensorboard
  --log-validation-ppl-to-tensorboard
  --log-memory-to-tensorboard
  --log-world-size-to-tensorboard
  --wandb-project
  --wandb-exp-name
  --wandb-save-dir
  --logging-level
  --log-straggler
  --disable-straggler-on-startup
  --straggler-ctrlr-port
  --straggler-minmax-count
  --run-workload-inspector-server
  --inference-batch-times-seqlen-threshold
  --max-tokens-to-oom
  --output-bert-embeddings
  --bert-embedder-type
  --flash-decode
  --enable-cuda-graph
  --cuda-graph-warmup-steps
  --external-cuda-graph
  --cuda-graph-scope
  --inference-max-requests
  --inference-max-seq-length
  --inference-dynamic-batching
  --inference-dynamic-batching-buffer-size-gb
  --inference-dynamic-batching-chunk-size
  --inference-dynamic-batching-buffer-guaranteed-fraction
  --inference-dynamic-batching-buffer-overflow-factor
  --inference-dynamic-batching-max-requests-override
  --inference-dynamic-batching-max-tokens-override
  --inference-dynamic-batching-num-cuda-graphs
  --symmetric-ar-type
  --nccl-all-reduce-for-prefill
  --mlp-chunks-for-prefill
  --fp8-format
  --fp8-recipe
  --fp8-margin
  --fp8-interval
  --fp8-amax-history-len
  --fp8-amax-compute-algo
  --no-fp8-wgrad
  --transformer-impl
  --fp8-param-gather
  --first-last-layers-bf16
  --num-layers-at-start-in-bf16
  --num-layers-at-end-in-bf16
  --te-rng-tracker
  --inference-rng-tracker
  --retro-project-dir
  --retro-add-retriever
  --retro-cyclic-train-iters
  --retro-encoder-layers
  --retro-encoder-hidden-dropout
  --retro-encoder-attention-dropout
  --retro-num-neighbors
  --retro-num-retrieved-chunks
  --retro-attention-gate
  --retro-no-verify-neighbor-count
  --enable-experimental
  --spec
  --hybrid-attention-ratio
  --hybrid-mlp-ratio
  --hybrid-override-pattern
  --mamba-state-dim
  --mamba-head-dim
  --mamba-num-groups
  --mamba-num-heads
  --is-hybrid-model
  --disable-mamba-mem-eff-path
  --yaml-cfg
  --use-precision-aware-optimizer
  --main-grads-dtype
  --main-params-dtype
  --exp-avg-dtype
  --exp-avg-sq-dtype
  --no-one-logger
  --one-logger-project
  --one-logger-run-name
  --one-logger-async
  --app-tag-run-name
  --app-tag-run-version
  --inprocess-restart
  --inprocess-max-iterations
  --inprocess-monitor-thread-interval
  --inprocess-monitor-process-interval
  --inprocess-progress-watchdog-interval
  --inprocess-heartbeat-interval
  --inprocess-soft-timeout
  --inprocess-hard-timeout
  --inprocess-heartbeat-timeout
  --inprocess-barrier-timeout
  --inprocess-completion-timeout
  --inprocess-last-call-wait
  --inprocess-termination-grace-time
  --inprocess-granularity
  --inprocess-active-world-size
  --inprocess-empty-cuda-cache
  --enable-ft-package
  --calc-ft-timeouts
  --config-logger-dir
  --error-injection-rate
  --error-injection-type
  --rerun-mode
  --disable-msc
  --kitchen-config-file
  --kitchen-recipe-number
  --sft
  --sft-tokenizer-prompt-format
